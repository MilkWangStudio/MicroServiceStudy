从AB实验的PRD设计图中进行分析
## AB实验层级
实验-规则集-规则(绑定人群)-对照组(绑定流量和算法)

其中对照组属于最细粒度。

## 版本设计
根据ABTesting EventLog.pdf中的字段分析，其中包括expt_version（实验生效规则版本）。因此版本应该是做在了实验层级，实验某一个规则变更后，所有规则跟随的实验版本均会变更。

## 效果追踪
效果追踪指目的是否达到，目前我们ABTesting主要用于“商品猜你喜欢”功能，因此效果有两个指标：
1. 用户是否点击商品
2. 用户点击商品后是否购买

效果追踪逻辑如下：
1. 用户(user)命中某实验(expt)版本(exptVersion)下某规则(rule)某对照组(group)后，执行某推荐算法(logic)，得到商品列表(Lis<goods>)
2. 用户(user)点击了商品(goods)
3. 用户(user)购买了商品(goods)
   
这种是基于时间Gap做漏斗来衡量追踪效果的方式。
效果追踪做好后，再不断反馈给算法，进行修正。
或者简单针对实验规则，得到一个结果优劣判断。

## 现有EventLog字段分析
1.基于效果追踪的逻辑，目前字段缺少了规则、对照组两个字段。
- 因为版本是做在实验上的，因此通过exptId+epxtVersion+用户所在人群，确实能定位到这个用户命中哪个规则，但是最细粒度的“对照组”就没法确定了，执行的算法是绑定在对照组上的。
- 另外因为“人群”是一个标签概念，一个人可能会在多个人群，如果实验规则中恰好配置了这几个人群，那分析模块是没法确认走到了哪个规则上。

2. （待讨论）缺少算法的版本概念
目前EventLog记录的算法是是URL，比较难去做复杂的分析。比如说效果追踪其中一个目的是反馈算法，修正算法。  
那么目前只能通过“serv_url”，这个url来聚合。这样就无法反向分析不通算法的AB测试记录。

虽然从示例中给出的哈布url，是包含版本号v1的，可以通过这个区分不通版本算法，但是没法做同一类算法聚合。

建议哈布执行的结果增加“版本”字段，AB系统将该字段透传写入EventLog，以便后续追踪和统计。